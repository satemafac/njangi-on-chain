"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[598],{6823:(e,t,r)=>{r.d(t,{A:()=>a});var c=r(4848);r(6540);var i=r(8071),s=r(4668);let a=e=>{let{isOpen:t,onClose:r,onConfirm:a,title:o,message:n,confirmText:h="Confirm",cancelText:l="Cancel",confirmButtonVariant:u="primary"}=e;return t?(0,c.jsx)(i.bL,{open:t,onOpenChange:r,children:(0,c.jsxs)(i.ZL,{children:[(0,c.jsx)(i.hJ,{className:"fixed inset-0 bg-black/30 z-40 data-[state=open]:animate-overlayShow"}),(0,c.jsxs)(i.UC,{className:"fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-white rounded-lg shadow-xl p-6 w-full max-w-md z-50 data-[state=open]:animate-contentShow focus:outline-none",children:[(0,c.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,c.jsx)(i.hE,{className:"text-lg font-semibold text-gray-900",children:o}),(0,c.jsx)(i.ZD,{asChild:!0,children:(0,c.jsx)("button",{className:"text-gray-400 hover:text-gray-600 p-1 rounded-full hover:bg-gray-100 transition-colors","aria-label":"Close",onClick:r,children:(0,c.jsx)(s.A,{className:"w-5 h-5"})})})]}),(0,c.jsx)(i.VY,{className:"text-sm text-gray-600 mb-6",children:n}),(0,c.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,c.jsx)(i.ZD,{asChild:!0,children:(0,c.jsx)("button",{className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors",onClick:r,children:l})}),(0,c.jsx)(i.rc,{asChild:!0,children:(0,c.jsx)("button",{className:"px-4 py-2 text-sm font-medium text-white rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-offset-2 transition-colors ".concat((()=>{switch(u){case"danger":return"bg-red-600 hover:bg-red-700 focus:ring-red-500";case"warning":return"bg-amber-500 hover:bg-amber-600 focus:ring-amber-500";default:return"bg-blue-600 hover:bg-blue-700 focus:ring-blue-500"}})()),onClick:()=>{a(),r()},children:h})})]})]})]})}):null}},6857:(e,t,r)=>{r.d(t,{j:()=>c});let c="0xd530bfd7511ac2d343646a8ca4e2e14ffb89e1ec69a38ff8fb99c415706d6154"},2876:(e,t,r)=>{r.d(t,{n:()=>i});class c{static getInstance(){return c.instance||(c.instance=new c),c.instance}loadCachedPrice(){{let e=localStorage.getItem(this.STORAGE_KEY);if(e)try{let{price:t,timestamp:r}=JSON.parse(e);this.cachedPrice=t,this.lastFetchTime=r}catch(e){console.error("Error parsing cached price data:",e)}}}saveCachedPrice(e,t){localStorage.setItem(this.STORAGE_KEY,JSON.stringify({price:e,timestamp:t}))}getFetchStatus(){return this.fetchStatus}isPriceAvailable(){return null!==this.cachedPrice}getCachedPrice(){return this.cachedPrice}async forceRefreshPrice(){return this.lastFetchTime=0,this.getSUIPrice()}async fetchBinancePrice(){try{let e=await fetch(this.BINANCE_API_URL);if(!e.ok)throw Error("Failed to fetch from Binance");let t=await e.json();if(t&&t.price)return parseFloat(t.price);return null}catch(e){return console.error("Error fetching from Binance:",e),null}}async fetchJupiterPrice(){try{let e=await fetch(this.BACKUP_API_URL);if(!e.ok)throw Error("Failed to fetch from Jupiter");let t=await e.json();if(t&&t.data&&t.data.SUI)return t.data.SUI.price;return null}catch(e){return console.error("Error fetching from Jupiter:",e),null}}async getSUIPrice(){let e=Date.now();if(null!==this.cachedPrice&&e-this.lastFetchTime<this.CACHE_DURATION)return console.log("Using cached SUI price: $".concat(this.cachedPrice," (").concat(Math.floor((e-this.lastFetchTime)/1e3),"s old)")),this.cachedPrice;this.fetchStatus="loading";try{let t=await fetch(this.PRIMARY_API_URL);if(!t.ok)throw Error("Failed to fetch SUI price from primary API");let r=await t.json();return this.cachedPrice=r.sui.usd,this.lastFetchTime=e,this.saveCachedPrice(this.cachedPrice,e),this.fetchStatus="success",console.log("Successfully fetched fresh SUI price: $".concat(this.cachedPrice)),this.cachedPrice}catch(c){console.error("Error fetching SUI price from primary API:",c);let t=await this.fetchJupiterPrice();if(null!==t)return this.cachedPrice=t,this.lastFetchTime=e,this.saveCachedPrice(this.cachedPrice,e),this.fetchStatus="success",console.log("Successfully fetched SUI price from Jupiter: $".concat(this.cachedPrice)),this.cachedPrice;let r=await this.fetchBinancePrice();if(null!==r)return this.cachedPrice=r,this.lastFetchTime=e,this.saveCachedPrice(this.cachedPrice,e),this.fetchStatus="success",console.log("Successfully fetched SUI price from Binance: $".concat(this.cachedPrice)),this.cachedPrice;if(this.fetchStatus="error",null!==this.cachedPrice&&e-this.lastFetchTime<216e5)return console.warn("Using stale cached price: $".concat(this.cachedPrice)),this.cachedPrice;return(null===this.cachedPrice||e-this.lastFetchTime>216e5)&&(console.warn("Using fallback price: $".concat(this.FALLBACK_PRICE)),this.cachedPrice=this.FALLBACK_PRICE,this.lastFetchTime=e,this.saveCachedPrice(this.cachedPrice,e)),this.cachedPrice}}constructor(){this.lastFetchTime=0,this.cachedPrice=null,this.CACHE_DURATION=3e5,this.PRIMARY_API_URL="https://api.coingecko.com/api/v3/simple/price?ids=sui&vs_currencies=usd",this.BACKUP_API_URL="https://price.jup.ag/v4/price?ids=SUI",this.BINANCE_API_URL="https://api.binance.com/api/v3/ticker/price?symbol=SUIUSDT",this.STORAGE_KEY="sui_cached_price",this.FALLBACK_PRICE=3.71,this.fetchStatus="idle",this.loadCachedPrice()}}let i=c.getInstance()},852:(e,t,r)=>{r.d(t,{v3:()=>a});var c=r(2636);r(2876);class i{validatePoolData(e){return!!e&&!!e&&"string"==typeof e.id&&"string"==typeof e.coinTypeA&&"string"==typeof e.coinTypeB&&!!e.reserves&&"object"==typeof e.reserves&&"string"==typeof e.reserves.a&&"string"==typeof e.reserves.b}async getSwapQuote(e,t,r,c,i){try{if(!c)throw Error("Missing circle ID");let s=new URLSearchParams({action:"getQuote",fromCoin:e,toCoin:t,amount:r.toString(),circleId:c,...i?{poolId:i}:{}}),a=await fetch("/api/circles/swap-config?".concat(s)),o=await a.json();if(!a.ok)throw Error(o.error||"Failed to get swap quote");if(!o.success||!o.quote)throw Error("Invalid response format");return o.quote}catch(e){if(console.error("Error in getSwapQuote:",e),e instanceof Error&&e.message.includes("pool data"))throw Error("Invalid pool data structure");throw e}}}class s{async getSwapEstimate(e,t,r,i,s){try{if(!r||r<=0)return c.oR.error("Please enter a valid amount"),null;if(!i)return c.oR.error("Circle ID is required for swap estimation"),null;return await this.router.getSwapQuote(e,t,r,i,s)}catch(t){console.error("Swap estimate error:",t);let e="Failed to get swap estimate";return t instanceof Error&&(t.message.includes("Invalid pool data structure")?e="The liquidity pool data is invalid or unavailable. Please try again later.":t.message.includes("Missing circle ID")&&(e="Circle ID is required for swap estimation")),c.oR.error(e),null}}async executeSwap(e,t,r,c,i){try{if(!i)throw Error("Missing circle ID");return console.log("Executing swap:",{fromCoin:e,toCoin:t,amountIn:r,minAmountOut:c,circleId:i}),{success:!0,txId:"0x".concat(Math.random().toString(16).slice(2))}}catch(e){return console.error("Swap execution error:",e),{success:!1,error:e instanceof Error?e.message:"Unknown error during swap"}}}constructor(){this.router=new i}}let a=new s}}]);